<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>casacore: casacore::FITSSpectralUtil Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">casacore
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecasacore.html">casacore</a></li><li class="navelem"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html">FITSSpectralUtil</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classcasacore_1_1FITSSpectralUtil-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">casacore::FITSSpectralUtil Class Reference<div class="ingroups"><a class="el" href="group__FITS__module.html">FITS_module</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A class with static functions to help deal with <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> spectral axes.  
 <a href="classcasacore_1_1FITSSpectralUtil.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="FITSSpectralUtil_8h_source.html">FITSSpectralUtil.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a0294f26cfdf2bffe21f67630de38f460"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html#a0294f26cfdf2bffe21f67630de38f460">fromFITSHeader</a> (<a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> &amp;spectralAxis, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;referenceChannel, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;referenceFrequency, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;deltaFrequency, <a class="el" href="classcasacore_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &gt; &amp;frequencies, <a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> &amp;refFrame, <a class="el" href="classcasacore_1_1MDoppler.html#acdcf5f4d8b46e24352dbd552a4d2aa3c">MDoppler::Types</a> &amp;velocityPreference, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;restFrequency, <a class="el" href="classcasacore_1_1LogIO.html">LogIO</a> &amp;logger, const <a class="el" href="classcasacore_1_1RecordInterface.html">RecordInterface</a> &amp;header, char prefix= 'c', <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> oneRelative=<a class="el" href="namespacecasacore.html#ad5c850f9e177173e0f7d0ad57091501d">True</a>)</td></tr>
<tr class="memdesc:a0294f26cfdf2bffe21f67630de38f460"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get information about the spectral axis from a record containing the <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> axis information.  <a href="#a0294f26cfdf2bffe21f67630de38f460">More...</a><br/></td></tr>
<tr class="separator:a0294f26cfdf2bffe21f67630de38f460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e42435d025e00a14a5dcb823abfb796"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html#a1e42435d025e00a14a5dcb823abfb796">toFITSHeader</a> (<a class="el" href="classcasacore_1_1String.html">String</a> &amp;ctype, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;crval, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;cdelt, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;crpix, <a class="el" href="classcasacore_1_1String.html">String</a> &amp;cunit, <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> &amp;haveAlt, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;altrval, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;altrpix, <a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> &amp;velref, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;restfreq, <a class="el" href="classcasacore_1_1String.html">String</a> &amp;specsys, <a class="el" href="classcasacore_1_1LogIO.html">LogIO</a> &amp;logger, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> refFrequency, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> refChannel, <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> freqIncrement, <a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> referenceFrame, <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> preferVelocity=<a class="el" href="namespacecasacore.html#ad5c850f9e177173e0f7d0ad57091501d">True</a>, <a class="el" href="classcasacore_1_1MDoppler.html#acdcf5f4d8b46e24352dbd552a4d2aa3c">MDoppler::Types</a> velocityPreference=<a class="el" href="classcasacore_1_1MDoppler.html#acdcf5f4d8b46e24352dbd552a4d2aa3caac6e43d4902f9c859d6fed52f0b06864">MDoppler::OPTICAL</a>, <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> preferWavelength=<a class="el" href="namespacecasacore.html#a11ef6530f2dc946f54d220fe416bfd41">False</a>, <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> airWavelength=<a class="el" href="namespacecasacore.html#a11ef6530f2dc946f54d220fe416bfd41">False</a>, <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> useDeprecatedCtypes=<a class="el" href="namespacecasacore.html#a11ef6530f2dc946f54d220fe416bfd41">False</a>)</td></tr>
<tr class="memdesc:a1e42435d025e00a14a5dcb823abfb796"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nearly the inverse of fromFITSHeader.  <a href="#a1e42435d025e00a14a5dcb823abfb796">More...</a><br/></td></tr>
<tr class="separator:a1e42435d025e00a14a5dcb823abfb796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49924c66a553d03d5e2cdb428ff86bf9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html#a49924c66a553d03d5e2cdb428ff86bf9">frameFromTag</a> (<a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> &amp;referenceFrame, const <a class="el" href="classcasacore_1_1String.html">String</a> &amp;tag, <a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> velref=-1)</td></tr>
<tr class="memdesc:a49924c66a553d03d5e2cdb428ff86bf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a reference frame tag (typically found as the characters after the first 4 characters in a ctype string for the frequency-like axis) to a <a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164" title="Types of known MFrequencies  Warning: The order defines the order in the translation matrix FromTo in...">MFrequency::Types</a> value.  <a href="#a49924c66a553d03d5e2cdb428ff86bf9">More...</a><br/></td></tr>
<tr class="separator:a49924c66a553d03d5e2cdb428ff86bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd375ce28f49afd4158e1c2f576440c8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html#afd375ce28f49afd4158e1c2f576440c8">tagFromFrame</a> (<a class="el" href="classcasacore_1_1String.html">String</a> &amp;tag, <a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> &amp;velref, <a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> referenceFrame)</td></tr>
<tr class="memdesc:afd375ce28f49afd4158e1c2f576440c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a reference frame tag from the given referenceFrame An appropriate velref value is also constructed (this may need to be adjusted by +256 if the velocity definition is radio before being used in a <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> file).  <a href="#afd375ce28f49afd4158e1c2f576440c8">More...</a><br/></td></tr>
<tr class="separator:afd375ce28f49afd4158e1c2f576440c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abff8f4120fa0c3ea166d2a9a3e5416d2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html#abff8f4120fa0c3ea166d2a9a3e5416d2">specsysFromFrame</a> (<a class="el" href="classcasacore_1_1String.html">String</a> &amp;specsys, <a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> referenceFrame)</td></tr>
<tr class="memdesc:abff8f4120fa0c3ea166d2a9a3e5416d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a SPECSYS keyword value from the given referenceFrame This returns False if the reference frame is not recognized.  <a href="#abff8f4120fa0c3ea166d2a9a3e5416d2">More...</a><br/></td></tr>
<tr class="separator:abff8f4120fa0c3ea166d2a9a3e5416d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e9161be2f10bc64c73bc22040c9c58a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html#a7e9161be2f10bc64c73bc22040c9c58a">frameFromSpecsys</a> (<a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> &amp;refFrame, <a class="el" href="classcasacore_1_1String.html">String</a> &amp;specsys)</td></tr>
<tr class="separator:a7e9161be2f10bc64c73bc22040c9c58a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ac69a5b4d17791a67935badf550bc5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FITSSpectralUtil.html#ab9ac69a5b4d17791a67935badf550bc5">refractiveIndex</a> (const <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;lambda_um)</td></tr>
<tr class="memdesc:ab9ac69a5b4d17791a67935badf550bc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The refractive index of air (argument can be vacuum wavelength or airwavelength) according to Greisen et al., 2006, A&amp;A, 464, 746.  <a href="#ab9ac69a5b4d17791a67935badf550bc5">More...</a><br/></td></tr>
<tr class="separator:ab9ac69a5b4d17791a67935badf550bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class with static functions to help deal with <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> spectral axes. </p>
<p><a class="anchor" id="FITSSpectralUtil_summary"></a> </p>
<h3>Intended use:</h3>
<p>Public interface</p>
<h3>Review Status</h3>
<dl>
<dt>Reviewed By:</dt>
<dd>Eric Sessoms</dd>
<dt>Date Reviewed:</dt>
<dd>2002/08/19</dd>
<dt>Test programs:</dt>
<dd>tFITSSpectralUtil</dd>
</dl>
<h3>Prerequisite</h3>
<ul>
<li>
General knowlege of <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a>, <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> keywords, and <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> coordinate conventions is assumed. </li>
<li>
Presumably you are using this in conjuction with the <a class="el" href="classcasacore_1_1FITSKeywordUtil.html">FITSKeywordUtil </a> class to get or set the <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> coordinate axis information. </li>
</ul>
<h3>Etymology</h3>
<p>This is a collection of static utility functions for use with <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> spectral axes.</p>
<h3>Synopsis</h3>
<p>This class provides functions to extract information from a <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> header about the spectral axis, to setup a <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> header with appropriate information for the spectral axis, and to translate to and from the <a class="el" href="classcasacore_1_1MFrequency.html" title="A Measure: wave characteristics. ">MFrequency</a> reference frame codes and their <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> equivalents. It is never necessary to construct a <a class="el" href="classcasacore_1_1FITSSpectralUtil.html" title="A class with static functions to help deal with FITS spectral axes. ">FITSSpectralUtil</a>, just use the static functions to help handle <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> Spectral axes.</p>
<h3>Example</h3>
<p><a class="anchor" id="FITSSpectralUtil_example"></a></p>
<div class="fragment"><div class="line">Record rec;</div>
<div class="line">... extract the FITS keyword values into rec <span class="keyword">using</span> FITSKeywordUtil</div>
<div class="line"><a class="code" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> whichAxis;</div>
<div class="line"><a class="code" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> refPix, refFreq, freqInc, restFreq;</div>
<div class="line">Vector&lt;Double&gt; freqs;</div>
<div class="line"><a class="code" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> refFrame;</div>
<div class="line"><a class="code" href="classcasacore_1_1MDoppler.html#acdcf5f4d8b46e24352dbd552a4d2aa3c">MDoppler::Types</a> veldef;</div>
<div class="line">LogIO logger;</div>
<div class="line"><a class="code" href="classcasacore_1_1FITSSpectralUtil.html#a0294f26cfdf2bffe21f67630de38f460">FITSSpectralUtil::fromFITSHeader</a>(whichAxis, refPix, refFreq,</div>
<div class="line">freqInc, freqs, refFrame, veldef, logger, rec);</div>
</div><!-- fragment --><h3>Motivation</h3>
<p>This is designed to be used after the keywords have been extracted from the <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> file using the <a class="el" href="classcasacore_1_1FITSKeywordUtil.html">FITSKeywordUtil </a> class. Extracting spectral axis and related information requires detailed knowledge of <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> conventions that this class strives to encapsulize.</p>
<h3>To Do</h3>
<ul>
<li>
General usage of units for frequency and velocity in "fromFITSHeader" (currently only implemented for wavelength) </li>
</ul>

<p>Definition at line <a class="el" href="FITSSpectralUtil_8h_source.html#l00103">103</a> of file <a class="el" href="FITSSpectralUtil_8h_source.html">FITSSpectralUtil.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a7e9161be2f10bc64c73bc22040c9c58a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> casacore::FITSSpectralUtil::frameFromSpecsys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> &amp;&#160;</td>
          <td class="paramname"><em>refFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>specsys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a49924c66a553d03d5e2cdb428ff86bf9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> casacore::FITSSpectralUtil::frameFromTag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> &amp;&#160;</td>
          <td class="paramname"><em>referenceFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcasacore_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a>&#160;</td>
          <td class="paramname"><em>velref</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert a reference frame tag (typically found as the characters after the first 4 characters in a ctype string for the frequency-like axis) to a <a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164" title="Types of known MFrequencies  Warning: The order defines the order in the translation matrix FromTo in...">MFrequency::Types</a> value. </p>
<p>A velref value (used in AIPS images to alternatively record the velocity reference frame) may also optionally be supplied. If tag is empty, velref will be used if it is &gt;= 0. This function returns False if: </p>
<ul>
<li>
The tag is not empty but is unrecognized. </li>
<li>
The tag is empty and velref is unrecognized. </li>
<li>
The tag is empty and velref is &lt; 0 (no velref was supplied). </li>
</ul>
<p>The default value (set when the return value is False) is TOPO. </p>

</div>
</div>
<a class="anchor" id="a0294f26cfdf2bffe21f67630de38f460"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> casacore::FITSSpectralUtil::fromFITSHeader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> &amp;&#160;</td>
          <td class="paramname"><em>spectralAxis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>referenceChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>referenceFrequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>deltaFrequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>frequencies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a> &amp;&#160;</td>
          <td class="paramname"><em>refFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MDoppler.html#acdcf5f4d8b46e24352dbd552a4d2aa3c">MDoppler::Types</a> &amp;&#160;</td>
          <td class="paramname"><em>velocityPreference</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>restFrequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1LogIO.html">LogIO</a> &amp;&#160;</td>
          <td class="paramname"><em>logger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcasacore_1_1RecordInterface.html">RecordInterface</a> &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>prefix</em> = <code>'c'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td>
          <td class="paramname"><em>oneRelative</em> = <code><a class="el" href="namespacecasacore.html#ad5c850f9e177173e0f7d0ad57091501d">True</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get information about the spectral axis from a record containing the <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> axis information. </p>
<p>Usually this will be from a <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> header using, for example, the <a class="el" href="classcasacore_1_1FITSKeywordUtil.html#ab64bfdc6219d6fc9ec79534044673d01" title="Extract keywords from in and define them in out. ">FITSKeywordUtil::getKeywords</a> method. referenceFrequency and deltaFrequency give the best possible linear frequency scale. prefix is the first character in the set of keywords describing the axes (e.g. crpix, crval, ctype - the prefix is 'c'). If oneRelative is False, the returned referenceChannel is decrimented from that found in header by 1. The naxis keywords are used to determine the output length of the freqs vector. This method returns False if: </p>
<ul>
<li>
no spectral axis is found. The freqs vector will have a length of zero. </li>
<li>
The expected set of axis description keywords is not found. </li>
<li>
The spectral axis is FELO but there is no rest frequency (making it impossible to convert to frequency and construct a freqs vector). </li>
<li>
The combination FELO and RADIO is used (which does not make sense). </li>
<li>
The combination VELO and OPTICAL is used (not yet implemented). </li>
</ul>

</div>
</div>
<a class="anchor" id="ab9ac69a5b4d17791a67935badf550bc5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> casacore::FITSSpectralUtil::refractiveIndex </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>lambda_um</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The refractive index of air (argument can be vacuum wavelength or airwavelength) according to Greisen et al., 2006, A&amp;A, 464, 746. </p>
<p>If vacuum wavelength is used there is an error of the order of 1E-9. Argument must be in micrometers! </p>

</div>
</div>
<a class="anchor" id="abff8f4120fa0c3ea166d2a9a3e5416d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> casacore::FITSSpectralUtil::specsysFromFrame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>specsys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a>&#160;</td>
          <td class="paramname"><em>referenceFrame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a SPECSYS keyword value from the given referenceFrame This returns False if the reference frame is not recognized. </p>
<p>The value of tag defaults to "TOPOCENT". </p>

</div>
</div>
<a class="anchor" id="afd375ce28f49afd4158e1c2f576440c8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> casacore::FITSSpectralUtil::tagFromFrame </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> &amp;&#160;</td>
          <td class="paramname"><em>velref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a>&#160;</td>
          <td class="paramname"><em>referenceFrame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a reference frame tag from the given referenceFrame An appropriate velref value is also constructed (this may need to be adjusted by +256 if the velocity definition is radio before being used in a <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> file). </p>
<p>This returns False if the reference frame is not recognized. The value of tag defaults to "-OBS". </p>

</div>
</div>
<a class="anchor" id="a1e42435d025e00a14a5dcb823abfb796"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> casacore::FITSSpectralUtil::toFITSHeader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>ctype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>crval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>cdelt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>crpix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>cunit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a> &amp;&#160;</td>
          <td class="paramname"><em>haveAlt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>altrval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>altrpix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> &amp;&#160;</td>
          <td class="paramname"><em>velref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a> &amp;&#160;</td>
          <td class="paramname"><em>restfreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1String.html">String</a> &amp;&#160;</td>
          <td class="paramname"><em>specsys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1LogIO.html">LogIO</a> &amp;&#160;</td>
          <td class="paramname"><em>logger</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a>&#160;</td>
          <td class="paramname"><em>refFrequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a>&#160;</td>
          <td class="paramname"><em>refChannel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#ada1f75eb2b38067e3eb1af7f5d69ebb2">Double</a>&#160;</td>
          <td class="paramname"><em>freqIncrement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MFrequency.html#a5033de7b159a385150bc49326e926164">MFrequency::Types</a>&#160;</td>
          <td class="paramname"><em>referenceFrame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td>
          <td class="paramname"><em>preferVelocity</em> = <code><a class="el" href="namespacecasacore.html#ad5c850f9e177173e0f7d0ad57091501d">True</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcasacore_1_1MDoppler.html#acdcf5f4d8b46e24352dbd552a4d2aa3c">MDoppler::Types</a>&#160;</td>
          <td class="paramname"><em>velocityPreference</em> = <code><a class="el" href="classcasacore_1_1MDoppler.html#acdcf5f4d8b46e24352dbd552a4d2aa3caac6e43d4902f9c859d6fed52f0b06864">MDoppler::OPTICAL</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td>
          <td class="paramname"><em>preferWavelength</em> = <code><a class="el" href="namespacecasacore.html#a11ef6530f2dc946f54d220fe416bfd41">False</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td>
          <td class="paramname"><em>airWavelength</em> = <code><a class="el" href="namespacecasacore.html#a11ef6530f2dc946f54d220fe416bfd41">False</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacecasacore.html#abd5691f9e13acc90d901e4007740ff98">Bool</a>&#160;</td>
          <td class="paramname"><em>useDeprecatedCtypes</em> = <code><a class="el" href="namespacecasacore.html#a11ef6530f2dc946f54d220fe416bfd41">False</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Nearly the inverse of fromFITSHeader. </p>
<p>This returns parameters which could be used in filling in a header record with appropriate values for the spectral axis given the arguments after the logger. The alternate axis description values are set when sufficient information is available. If they have been set, haveAlt will be set to True. </p>
<ul>
<li>
Note that the output arguments after "haveAlt" should not be written to the <a class="el" href="classcasacore_1_1FITS.html" title="static functions and enumerations ">FITS</a> header unless haveAlt is true. </li>
<li>
Note that restfreq is both an input and an output. If there is no rest frequency, set it to be &lt;=0 on input. </li>
</ul>
<p>If preferVelocity is True, the axis description parameters will be set to those appropriate for a velocity axis given the referenceFrame, and velocityPreference if possible. If preferWavelength is True, the axis description parameters will be set to those appropriate for a wavelength axis given the referenceFrame if possible. The two preferences cannot be True at the same time. If airWavelength is True, the axis description parameters will be set to those appropriate for an air wavelength axis given the referenceFrame if possible. This parameter has an effect only if preferWavelength is True.</p>
<p>This method always returns True. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>fits/FITS/<a class="el" href="FITSSpectralUtil_8h_source.html">FITSSpectralUtil.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
