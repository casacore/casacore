<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>casacore: casacore::Memory Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">casacore
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecasacore.html">casacore</a></li><li class="navelem"><a class="el" href="classcasacore_1_1Memory.html">Memory</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classcasacore_1_1Memory-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">casacore::Memory Class Reference<div class="ingroups"><a class="el" href="group__OS__module.html">OS_module</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classcasacore_1_1Memory.html" title="Memory related information and utilities. use visibility=export&gt; ">Memory</a> related information and utilities. use visibility=export&gt;  
 <a href="classcasacore_1_1Memory.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Memory_8h_source.html">Memory.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a3d1f76afe47227d11943f885db81cf12"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1Memory.html#a3d1f76afe47227d11943f885db81cf12">allocatedMemoryInBytes</a> ()</td></tr>
<tr class="memdesc:a3d1f76afe47227d11943f885db81cf12"><td class="mdescLeft">&#160;</td><td class="mdescRight">How much memory has been allocated by the programmer (via either <code>new</code> or <code>malloc</code>.  <a href="#a3d1f76afe47227d11943f885db81cf12">More...</a><br/></td></tr>
<tr class="separator:a3d1f76afe47227d11943f885db81cf12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4567907b231152ec281abfe162e8f60f"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1Memory.html#a4567907b231152ec281abfe162e8f60f">assignedMemoryInBytes</a> ()</td></tr>
<tr class="memdesc:a4567907b231152ec281abfe162e8f60f"><td class="mdescLeft">&#160;</td><td class="mdescRight">How much memory in in the memory "pool" of this process.  <a href="#a4567907b231152ec281abfe162e8f60f">More...</a><br/></td></tr>
<tr class="separator:a4567907b231152ec281abfe162e8f60f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8cfc480b2ef4046d2cc8623c4acf57e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1Memory.html#ae8cfc480b2ef4046d2cc8623c4acf57e">releaseMemory</a> ()</td></tr>
<tr class="memdesc:ae8cfc480b2ef4046d2cc8623c4acf57e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to release memory which has been assigned but not allocated.  <a href="#ae8cfc480b2ef4046d2cc8623c4acf57e">More...</a><br/></td></tr>
<tr class="separator:ae8cfc480b2ef4046d2cc8623c4acf57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05c74dde37fa231d8a7d216fa19d0dc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1Memory.html#af05c74dde37fa231d8a7d216fa19d0dc">setMemoryOptions</a> ()</td></tr>
<tr class="memdesc:af05c74dde37fa231d8a7d216fa19d0dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">setMemoryOptions and setMemoryOption are typically front ends for mallopt which lets the user control some memory allocation parameters.  <a href="#af05c74dde37fa231d8a7d216fa19d0dc">More...</a><br/></td></tr>
<tr class="separator:af05c74dde37fa231d8a7d216fa19d0dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9b64c54884efc9f3e2be001c57c8ea"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1Memory.html#a0b9b64c54884efc9f3e2be001c57c8ea">setMemoryOption</a> (int, int)</td></tr>
<tr class="separator:a0b9b64c54884efc9f3e2be001c57c8ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classcasacore_1_1Memory.html" title="Memory related information and utilities. use visibility=export&gt; ">Memory</a> related information and utilities. use visibility=export&gt; </p>
<p><a class="anchor" id="Memory_summary"></a> </p>
<h3>Review Status</h3>
<dl>
<dt>Reviewed By:</dt>
<dd>rmarson</dd>
<dt>Date Reviewed:</dt>
<dd>1997/11/12</dd>
<dt>Test programs:</dt>
<dd>tMemory</dd>
</dl>
<h3>Prerequisite</h3>
<ul>
<li>
General knowledge of C/C++ memory allocation issues. </li>
</ul>
<h3>Synopsis</h3>
<p>This class should generally not be used by general application programmers. Instead you should use the memory information available in the <a class="el" href="classcasacore_1_1AppInfo.html">AppInfo</a> class.</p>
<p>This class reports on the dynamic ("heap") memory used by this process, and it can attempt to release some of that memory back to the operating system. The class reports on <code>allocated</code> memory, which is memory that the process has actually requested, typically via <code>new</code>, but also via <code>malloc</code>. The number might be somewhat larger than actually requested by the programmer to account for overhead and alignment considerations. The class also reports <code>assigned</code> memory, which is the total memory that the process has been given, not all of which has been allocated by the programmer. Typically this results from memory which has been <code>delete</code>d by the programmer, but has not been released to the OS on the assumption that it might be needed again. (Getting and releasing memory to the OS can be expensive).</p>
<p>At present, the values for allocated and assigned memory are obtained via the <code><a class="el" href="structmallinfo.html">mallinfo()</a></code> call, usually defined in <code><a class="el" href="malloc_8h.html">malloc.h</a></code>. This call seems to be adequately portable for Unix. Another alternative would be to replace global operators <code>new</code> and <code>delete</code> for systems that do not have <code><a class="el" href="structmallinfo.html">mallinfo()</a></code>.</p>
<p>The member function <code><a class="el" href="classcasacore_1_1Memory.html#ae8cfc480b2ef4046d2cc8623c4acf57e" title="Attempt to release memory which has been assigned but not allocated. ">releaseMemory()</a></code> on some system will attempt to return assigned but unallocated memory to the OS. If the compilation system cannot automatically determine how to do this (at present it only recognizes Linux systems), you can you this function by setting the preprocessor symbol <code>AIPS_RELEASEMEM</code> to a C++ statement which will release memory to the OS. For example, if you are using GNU malloc you could set it to <code>malloc_trim(0)</code>. Note that <code><a class="el" href="classcasacore_1_1Memory.html#ae8cfc480b2ef4046d2cc8623c4acf57e" title="Attempt to release memory which has been assigned but not allocated. ">releaseMemory()</a></code> might be a no-op on many systems, and that calling it might be expensive so it should not be called in tight-loops.</p>
<p>Note that this class does not use any Casacore facilities and does not cause any Casacore code to be linked in to your executable.</p>
<h3>Example</h3>
<p><a class="anchor" id="Memory_example1"></a> We could attempt to return memory to the OS when we are wasting a lot of memory as follows. </p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="classcasacore_1_1Memory.html#a4567907b231152ec281abfe162e8f60f">Memory::assignedMemoryInBytes</a>() - <a class="code" href="classcasacore_1_1Memory.html#a3d1f76afe47227d11943f885db81cf12">Memory::allocatedMemoryInBytes</a>() &gt;</div>
<div class="line">1024*1024) {</div>
<div class="line"><a class="code" href="classcasacore_1_1Memory.html#ae8cfc480b2ef4046d2cc8623c4acf57e">Memory::releaseMemory</a>(); <span class="comment">// Attempt to release if more than 1M &quot;wasted&quot;</span></div>
<div class="line">}</div>
</div><!-- fragment --><h3>Motivation</h3>
<p>At run time we need to be able to make decisions about whether we should keep things in memory or about whether we should do I/O (e.g. use an <a class="el" href="classcasacore_1_1Array.html" title="template &lt;class T, class U&gt; class vector; ">Array</a> or a <a class="el" href="classcasacore_1_1PagedArray.html" title="A Lattice that is read from or written to disk. ">PagedArray</a>).</p>
<h3>To Do</h3>
<ul>
<li>
We might some day want to put actual allocation/deallocation functions in here if the <a class="el" href="structmallinfo.html">mallinfo()</a> interface turns out to not be portable. </li>
</ul>

<p>Definition at line <a class="el" href="Memory_8h_source.html#l00110">110</a> of file <a class="el" href="Memory_8h_source.html">Memory.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a3d1f76afe47227d11943f885db81cf12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t casacore::Memory::allocatedMemoryInBytes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>How much memory has been allocated by the programmer (via either <code>new</code> or <code>malloc</code>. </p>
<p>This can include some extra overhead bytes, e.g. for alignment reasons. </p>

</div>
</div>
<a class="anchor" id="a4567907b231152ec281abfe162e8f60f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t casacore::Memory::assignedMemoryInBytes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>How much memory in in the memory "pool" of this process. </p>
<p>This includes not only the allocated memory, but some memory which has been <code>delete</code>d but not returned to the OS on the assumption that it might be needed again. </p>

</div>
</div>
<a class="anchor" id="ae8cfc480b2ef4046d2cc8623c4acf57e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void casacore::Memory::releaseMemory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to release memory which has been assigned but not allocated. </p>
<p>On many systems this will be a no-op, and even on systems in which it does something the amount of reclaimed memory cannot be specified. Since this function may be somewhat expensive to call it should not be called too often. </p>

</div>
</div>
<a class="anchor" id="a0b9b64c54884efc9f3e2be001c57c8ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int casacore::Memory::setMemoryOption </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af05c74dde37fa231d8a7d216fa19d0dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void casacore::Memory::setMemoryOptions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>setMemoryOptions and setMemoryOption are typically front ends for mallopt which lets the user control some memory allocation parameters. </p>
<p>setMemoryOptions is intended to be called only once at the start of a program while setMemoryOption could be called where desired (but see mallopt man page for possible side effects). Note: these two functions were added to address in a general way a memory fragmentation problem encountered on by the MIPSpro C++ compiler on the SGI. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>casa/OS/<a class="el" href="Memory_8h_source.html">Memory.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
