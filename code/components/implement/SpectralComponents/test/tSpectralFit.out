Test RecordInterface
---------------------------------------------------
toRecord
fromRecord

Test SpectralEstimate
---------------------------------------------------
Made spectrum with components: 
GAUSSIAN element: 
  Amplitude: 5, 0
  Center:    45, 0
  Sigma:     1.1, 0

GAUSSIAN element: 
  Amplitude: 4, 0
  Center:    50, 0
  Sigma:     1.1, 0

GAUSSIAN element: 
  Amplitude: 6, 0
  Center:    55, 0
  Sigma:     1.1, 0

Found (using rms, cutoff, minsig, q): (0.5, 1, 0.5, 2) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    55.0715, 0
  Sigma:     1.33398, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    44.9152, 0
  Sigma:     1.32309, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0043, 0
  Sigma:     1.26335, 0

Minimum, Maximum residuals: -0.961305, 0.0086807
Window (using rms, cutoff, minsig, q): (0.5, 1, 0.5, 2) 0 estimates
Found (using rms, cutoff, minsig, q): (0.5, 1, 0.5, 1) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    54.9829, 0
  Sigma:     1.17129, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    45.0202, 0
  Sigma:     1.17355, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0182, 0
  Sigma:     1.38534, 0

Found (using rms, cutoff, minsig, q): (0, 0, 0, 1) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    54.9829, 0
  Sigma:     1.17129, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    45.0202, 0
  Sigma:     1.17355, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0182, 0
  Sigma:     1.38534, 0

Found (using rms, cutoff, minsig, q): (0, 0, 0, 2) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    55.0715, 0
  Sigma:     1.33398, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    44.9152, 0
  Sigma:     1.32309, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0043, 0
  Sigma:     1.26335, 0

Test SpectralFit
---------------------------------------------------
Spectral elements: 
GAUSSIAN element: 
  Amplitude: 1, 0
  Center:    1402.5, 0
  Sigma:     0.0195312, 0

GAUSSIAN element: 
  Amplitude: 2.5, 0
  Center:    1405, 0
  Sigma:     0.0390625, 0

GAUSSIAN element: 
  Amplitude: 0.5, 0
  Center:    1407.5, 0
  Sigma:     0.078125, 0

GAUSSIAN element: 
  Amplitude: 5, 0
  Center:    1403, 0
  Sigma:     0.0292969, 0

---------------------------------------------------
Data for frequencies 1402.93 - 1403.08
1402.93: 0.219133
1402.94: -0.480645
1402.95: -0.281389
1402.96: 0.0423511
1402.97: 0.0837382
1402.98: 1.05514
1402.99: 3.14053
1403: 4.93017
1403.01: 4.53475
1403.02: 1.54477
1403.03: 0.247699
1403.04: -0.50962
1403.05: 0.0446798
1403.06: -0.0518962
1403.07: -0.750935
1403.08: 0.499586
---------------------------------------------------
Specify fitter on the 4 gaussians:
GAUSSIAN element: 
  Amplitude: 1, 0
  Center:    1402.5, 0
  Sigma:     0.0195312, 0

GAUSSIAN element: 
  Amplitude: 2.5, 0
  Center:    1405, 0
  Sigma:     0.0390625, 0

GAUSSIAN element: 
  Amplitude: 0.5, 0
  Center:    1407.5, 0
  Sigma:     0.078125, 0

GAUSSIAN element: 
  Amplitude: 5, 0
  Center:    1403, 0
  Sigma:     0.0292969, 0

---------------------------------------------------
Execute the fitter, can do (1:Y): 1
The results: 
GAUSSIAN element: 
  Amplitude: 0.918402, 0.310425
  Center:    1402.5, 0.0034832
  Sigma:     0.00881809, 0.00343807
Parameters: [0.918402, 1402.5, 0.00881809]
Errors:     [0.310425, 0.0034832, 0.00343807]

GAUSSIAN element: 
  Amplitude: 2.76117, 0.238197
  Center:    1405, 0.00151174
  Sigma:     0.0151761, 0.00151174
Parameters: [2.76117, 1405, 0.0151761]
Errors:     [0.238197, 0.00151174, 0.00151174]

GAUSSIAN element: 
  Amplitude: 0.602535, 0.178909
  Center:    1407.48, 0.0096871
  Sigma:     0.0244648, 0.0096871
Parameters: [0.602535, 1407.48, 0.0244648]
Errors:     [0.178909, 0.0096871, 0.0096871]

GAUSSIAN element: 
  Amplitude: 5.24752, 0.272236
  Center:    1403, 0.00069599
  Sigma:     0.0116179, 0.000695958
Parameters: [5.24752, 1403, 0.0116179]
Errors:     [0.272236, 0.00069599, 0.000695958]

>>>
Number of iterations: 13
<<<
---------------------------------------------------
GAUSSIAN element: 
  Amplitude: 1, 0
  Center:    1402.5, 0
  Sigma:     0.0195312, 0

GAUSSIAN element: 
  Amplitude: 2.5, 0
  Center:    1405, 0
  Sigma:     0.0390625, 0

GAUSSIAN element: 
  Amplitude: 0.5, 0
  Center:    1407.5, 0
  Sigma:     0.078125, 0

GAUSSIAN element: 
  Amplitude: 5, 0 (fixed)
  Center:    1403, 0
  Sigma:     0.0292969, 0

---------------------------------------------------
Execute the fitter again with a fixed ampl, can do (1:Y): 1
The results: 
GAUSSIAN element: 
  Amplitude: 0.918402, 0.310404
  Center:    1402.5, 0.00348297
  Sigma:     0.00881809, 0.00343784
Parameters: [0.918402, 1402.5, 0.00881809]
Errors:     [0.310404, 0.00348297, 0.00343784]

GAUSSIAN element: 
  Amplitude: 2.76117, 0.238181
  Center:    1405, 0.00151164
  Sigma:     0.0151761, 0.00151164
Parameters: [2.76117, 1405, 0.0151761]
Errors:     [0.238181, 0.00151164, 0.00151164]

GAUSSIAN element: 
  Amplitude: 0.602535, 0.178896
  Center:    1407.48, 0.00968644
  Sigma:     0.0244648, 0.00968644
Parameters: [0.602535, 1407.48, 0.0244648]
Errors:     [0.178896, 0.00968644, 0.00968644]

GAUSSIAN element: 
  Amplitude: 5, 0 (fixed)
  Center:    1403, 0.000741394
  Sigma:     0.0119707, 0.000605336
Parameters: [5, 1403, 0.0119707]
Errors:     [0, 0.000741394, 0.000605336]

>>>
Number of iterations: 13
<<<
---------------------------------------------------
Different start values: 
GAUSSIAN element: 
  Amplitude: 0.9, 0
  Center:    1402.5, 0
  Sigma:     0.0185547, 0

GAUSSIAN element: 
  Amplitude: 2.25, 0
  Center:    1405, 0
  Sigma:     0.0371094, 0

GAUSSIAN element: 
  Amplitude: 0.45, 0
  Center:    1407.5, 0
  Sigma:     0.0742188, 0

GAUSSIAN element: 
  Amplitude: 4.5, 0
  Center:    1403, 0
  Sigma:     0.027832, 0

Execute the fitter, can do (1:Y): 1
The results: 
GAUSSIAN element: 
  Amplitude: 0.915329, 0.311423
  Center:    1402.5, 0.00345717
  Sigma:     0.00887656, 0.00340439

GAUSSIAN element: 
  Amplitude: 2.76116, 0.238208
  Center:    1405, 0.00151172
  Sigma:     0.0151761, 0.00151172

GAUSSIAN element: 
  Amplitude: 0.590133, 0.178593
  Center:    1407.48, 0.00985607
  Sigma:     0.0255433, 0.00985607

GAUSSIAN element: 
  Amplitude: 5.24751, 0.272244
  Center:    1403, 0.000695996
  Sigma:     0.0116179, 0.000695964

>>>
Number of iterations: 12
<<<
---------------------------------------------------
Differences: 
Min difference: -1.09994, max: 1.01271, average: 0.00967598, sigma: 0.0100326
---------------------------------------------------
---------------------------------------------------
Estimates: 
Found 20 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 4.93017, 0
  Center:    307.195, 0
  Sigma:     3.05174, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 2.79525, 0
  Center:    511.819, 0
  Sigma:     3.29148, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 0.906691, 0
  Center:    766.653, 0
  Sigma:     2.31423, 0

Estimate 3: GAUSSIAN element: 
  Amplitude: 0.90563, 0
  Center:    501.372, 0
  Sigma:     3.60214, 0

Estimate 4: GAUSSIAN element: 
  Amplitude: 0.861827, 0
  Center:    839.949, 0
  Sigma:     3.43708, 0

Estimate 5: GAUSSIAN element: 
  Amplitude: 0.846625, 0
  Center:    112.878, 0
  Sigma:     2.28534, 0

Estimate 6: GAUSSIAN element: 
  Amplitude: 0.751603, 0
  Center:    871.157, 0
  Sigma:     2.78939, 0

Estimate 7: GAUSSIAN element: 
  Amplitude: 0.699624, 0
  Center:    36.4464, 0
  Sigma:     3.65743, 0

Estimate 8: GAUSSIAN element: 
  Amplitude: 0.682235, 0
  Center:    395.917, 0
  Sigma:     3.5893, 0

Estimate 9: GAUSSIAN element: 
  Amplitude: 0.663379, 0
  Center:    450.12, 0
  Sigma:     0.548263, 0

Estimate 10: GAUSSIAN element: 
  Amplitude: 0.640783, 0
  Center:    827.254, 0
  Sigma:     3.35359, 0

Estimate 11: GAUSSIAN element: 
  Amplitude: 0.616448, 0
  Center:    245.555, 0
  Sigma:     3.28022, 0

Estimate 12: GAUSSIAN element: 
  Amplitude: 0.578568, 0
  Center:    120.043, 0
  Sigma:     1.45528, 0

Estimate 13: GAUSSIAN element: 
  Amplitude: 0.569486, 0
  Center:    663.971, 0
  Sigma:     1.81295, 0

Estimate 14: GAUSSIAN element: 
  Amplitude: 0.56377, 0
  Center:    611.848, 0
  Sigma:     2.99822, 0

Estimate 15: GAUSSIAN element: 
  Amplitude: 0.561451, 0
  Center:    937.91, 0
  Sigma:     2.32834, 0

Estimate 16: GAUSSIAN element: 
  Amplitude: 0.54666, 0
  Center:    336.559, 0
  Sigma:     1.8761, 0

Estimate 17: GAUSSIAN element: 
  Amplitude: 0.524891, 0
  Center:    443.644, 0
  Sigma:     0.809077, 0

Estimate 18: GAUSSIAN element: 
  Amplitude: 0.523377, 0
  Center:    645.266, 0
  Sigma:     3.01063, 0

Estimate 19: GAUSSIAN element: 
  Amplitude: 0.515985, 0
  Center:    446.61, 0
  Sigma:     1.18317, 0

---------------------------------------------------
Limited number of estimates: 
Found 4 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 4.93017, 0
  Center:    307.195, 0
  Sigma:     3.05174, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 2.79525, 0
  Center:    511.819, 0
  Sigma:     3.29148, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 0.906691, 0
  Center:    766.653, 0
  Sigma:     2.31423, 0

Estimate 3: GAUSSIAN element: 
  Amplitude: 0.90563, 0
  Center:    501.372, 0
  Sigma:     3.60214, 0

---------------------------------------------------
