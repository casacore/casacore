Test RecordInterface
---------------------------------------------------
toRecord
fromRecord

Test SpectralEstimate
---------------------------------------------------
Made spectrum with components: 
GAUSSIAN element: 
  Amplitude: 5, 0
  Center:    45, 0
  Sigma:     1.1, 0

GAUSSIAN element: 
  Amplitude: 4, 0
  Center:    50, 0
  Sigma:     1.1, 0

GAUSSIAN element: 
  Amplitude: 6, 0
  Center:    55, 0
  Sigma:     1.1, 0

Found (using rms, cutoff, minsig, q): (0.5, 1, 0.5, 2) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    55.0715, 0
  Sigma:     1.33398, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    44.9152, 0
  Sigma:     1.32309, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0043, 0
  Sigma:     1.26335, 0

Minimum, Maximum residuals: -0.961305, 0.0086807
Window (using rms, cutoff, minsig, q): (0.5, 1, 0.5, 2) 0 estimates
Found (using rms, cutoff, minsig, q): (0.5, 1, 0.5, 1) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    54.9829, 0
  Sigma:     1.17129, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    45.0202, 0
  Sigma:     1.17355, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0182, 0
  Sigma:     1.38534, 0

Found (using rms, cutoff, minsig, q): (0, 0, 0, 1) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    54.9829, 0
  Sigma:     1.17129, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    45.0202, 0
  Sigma:     1.17355, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0182, 0
  Sigma:     1.38534, 0

Found (using rms, cutoff, minsig, q): (0, 0, 0, 2) 3 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 6.00013, 0
  Center:    55.0715, 0
  Sigma:     1.33398, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 5.00013, 0
  Center:    44.9152, 0
  Sigma:     1.32309, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 4.00036, 0
  Center:    50.0043, 0
  Sigma:     1.26335, 0

Test SpectralFit
---------------------------------------------------
Spectral elements: 
GAUSSIAN element: 
  Amplitude: 1, 0
  Center:    1402.5, 0
  Sigma:     0.0195312, 0

GAUSSIAN element: 
  Amplitude: 2.5, 0
  Center:    1405, 0
  Sigma:     0.0390625, 0

GAUSSIAN element: 
  Amplitude: 0.5, 0
  Center:    1407.5, 0
  Sigma:     0.078125, 0

GAUSSIAN element: 
  Amplitude: 5, 0
  Center:    1403, 0
  Sigma:     0.0292969, 0

---------------------------------------------------
Data for frequencies 1402.93 - 1403.08
1402.93: 0.219133
1402.94: -0.480645
1402.95: -0.281389
1402.96: 0.0423511
1402.97: 0.0837382
1402.98: 1.05514
1402.99: 3.14053
1403: 4.93017
1403.01: 4.53475
1403.02: 1.54477
1403.03: 0.247699
1403.04: -0.50962
1403.05: 0.0446798
1403.06: -0.0518962
1403.07: -0.750935
1403.08: 0.499586
---------------------------------------------------
Specify fitter on the 4 gaussians:
GAUSSIAN element: 
  Amplitude: 1, 0
  Center:    1402.5, 0
  Sigma:     0.0195312, 0

GAUSSIAN element: 
  Amplitude: 2.5, 0
  Center:    1405, 0
  Sigma:     0.0390625, 0

GAUSSIAN element: 
  Amplitude: 0.5, 0
  Center:    1407.5, 0
  Sigma:     0.078125, 0

GAUSSIAN element: 
  Amplitude: 5, 0
  Center:    1403, 0
  Sigma:     0.0292969, 0

---------------------------------------------------
Execute the fitter, can do (1:Y): 1
The results: 
GAUSSIAN element: 
  Amplitude: 0.917797, 0.310674
  Center:    1402.5, 0.00347673
  Sigma:     0.00882989, 0.00343021
Parameters: [0.917797, 1402.5, 0.00882989]
Errors:     [0.310674, 0.00347673, 0.00343021]

GAUSSIAN element: 
  Amplitude: 2.76117, 0.238196
  Center:    1405, 0.00151172
  Sigma:     0.0151761, 0.00151172
Parameters: [2.76117, 1405, 0.0151761]
Errors:     [0.238196, 0.00151172, 0.00151172]

GAUSSIAN element: 
  Amplitude: 0.612907, 0.18968
  Center:    1407.48, 0.0085527
  Sigma:     0.0239303, 0.0085527
Parameters: [0.612907, 1407.48, 0.0239303]
Errors:     [0.18968, 0.0085527, 0.0085527]

GAUSSIAN element: 
  Amplitude: 5.24752, 0.272235
  Center:    1403, 0.000695977
  Sigma:     0.0116179, 0.000695945
Parameters: [5.24752, 1403, 0.0116179]
Errors:     [0.272235, 0.000695977, 0.000695945]

>>>
Number of iterations: 29
<<<
---------------------------------------------------
GAUSSIAN element: 
  Amplitude: 1, 0
  Center:    1402.5, 0
  Sigma:     0.0195312, 0

GAUSSIAN element: 
  Amplitude: 2.5, 0
  Center:    1405, 0
  Sigma:     0.0390625, 0

GAUSSIAN element: 
  Amplitude: 0.5, 0
  Center:    1407.5, 0
  Sigma:     0.078125, 0

GAUSSIAN element: 
  Amplitude: 5, 0 (fixed)
  Center:    1403, 0
  Sigma:     0.0292969, 0

---------------------------------------------------
Execute the fitter again with a fixed ampl, can do (1:Y): 1
The results: 
GAUSSIAN element: 
  Amplitude: 0.917772, 0.310662
  Center:    1402.5, 0.00347618
  Sigma:     0.00883038, 0.00342961
Parameters: [0.917772, 1402.5, 0.00883038]
Errors:     [0.310662, 0.00347618, 0.00342961]

GAUSSIAN element: 
  Amplitude: 2.76117, 0.23818
  Center:    1405, 0.00151162
  Sigma:     0.0151761, 0.00151162
Parameters: [2.76117, 1405, 0.0151761]
Errors:     [0.23818, 0.00151162, 0.00151162]

GAUSSIAN element: 
  Amplitude: 0.61293, 0.18968
  Center:    1407.48, 0.00855088
  Sigma:     0.0239286, 0.00855088
Parameters: [0.61293, 1407.48, 0.0239286]
Errors:     [0.18968, 0.00855088, 0.00855088]

GAUSSIAN element: 
  Amplitude: 5, 0 (fixed)
  Center:    1403, 0.000741387
  Sigma:     0.0119707, 0.00060533
Parameters: [5, 1403, 0.0119707]
Errors:     [0, 0.000741387, 0.00060533]

>>>
Number of iterations: 26
<<<
---------------------------------------------------
Different start values: 
GAUSSIAN element: 
  Amplitude: 0.9, 0
  Center:    1402.5, 0
  Sigma:     0.0185547, 0

GAUSSIAN element: 
  Amplitude: 2.25, 0
  Center:    1405, 0
  Sigma:     0.0371094, 0

GAUSSIAN element: 
  Amplitude: 0.45, 0
  Center:    1407.5, 0
  Sigma:     0.0742188, 0

GAUSSIAN element: 
  Amplitude: 4.5, 0
  Center:    1403, 0
  Sigma:     0.027832, 0

Execute the fitter, can do (1:Y): 1
The results: 
GAUSSIAN element: 
  Amplitude: 0.917785, 0.310679
  Center:    1402.5, 0.00347653
  Sigma:     0.00883013, 0.00342999

GAUSSIAN element: 
  Amplitude: 2.76117, 0.238196
  Center:    1405, 0.00151172
  Sigma:     0.0151761, 0.00151172

GAUSSIAN element: 
  Amplitude: 0.61293, 0.189693
  Center:    1407.48, 0.00855143
  Sigma:     0.0239285, 0.00855143

GAUSSIAN element: 
  Amplitude: 5.24752, 0.272235
  Center:    1403, 0.000695977
  Sigma:     0.0116179, 0.000695945

>>>
Number of iterations: 32
<<<
---------------------------------------------------
Differences: 
Min difference: -1.09994, max: 1.01271, average: 0.00978336, sigma: 0.0100325
---------------------------------------------------
---------------------------------------------------
Estimates: 
Found 20 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 4.93017, 0
  Center:    307.195, 0
  Sigma:     3.05174, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 2.79525, 0
  Center:    511.819, 0
  Sigma:     3.29148, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 0.906691, 0
  Center:    766.653, 0
  Sigma:     2.31423, 0

Estimate 3: GAUSSIAN element: 
  Amplitude: 0.90563, 0
  Center:    501.372, 0
  Sigma:     3.60214, 0

Estimate 4: GAUSSIAN element: 
  Amplitude: 0.861827, 0
  Center:    839.949, 0
  Sigma:     3.43708, 0

Estimate 5: GAUSSIAN element: 
  Amplitude: 0.846625, 0
  Center:    112.878, 0
  Sigma:     2.28534, 0

Estimate 6: GAUSSIAN element: 
  Amplitude: 0.751603, 0
  Center:    871.157, 0
  Sigma:     2.78939, 0

Estimate 7: GAUSSIAN element: 
  Amplitude: 0.699624, 0
  Center:    36.4464, 0
  Sigma:     3.65743, 0

Estimate 8: GAUSSIAN element: 
  Amplitude: 0.682235, 0
  Center:    395.917, 0
  Sigma:     3.5893, 0

Estimate 9: GAUSSIAN element: 
  Amplitude: 0.663379, 0
  Center:    450.12, 0
  Sigma:     0.548263, 0

Estimate 10: GAUSSIAN element: 
  Amplitude: 0.640783, 0
  Center:    827.254, 0
  Sigma:     3.35359, 0

Estimate 11: GAUSSIAN element: 
  Amplitude: 0.616448, 0
  Center:    245.555, 0
  Sigma:     3.28022, 0

Estimate 12: GAUSSIAN element: 
  Amplitude: 0.578568, 0
  Center:    120.043, 0
  Sigma:     1.45528, 0

Estimate 13: GAUSSIAN element: 
  Amplitude: 0.569486, 0
  Center:    663.971, 0
  Sigma:     1.81295, 0

Estimate 14: GAUSSIAN element: 
  Amplitude: 0.56377, 0
  Center:    611.848, 0
  Sigma:     2.99822, 0

Estimate 15: GAUSSIAN element: 
  Amplitude: 0.561451, 0
  Center:    937.91, 0
  Sigma:     2.32834, 0

Estimate 16: GAUSSIAN element: 
  Amplitude: 0.54666, 0
  Center:    336.559, 0
  Sigma:     1.8761, 0

Estimate 17: GAUSSIAN element: 
  Amplitude: 0.524891, 0
  Center:    443.644, 0
  Sigma:     0.809077, 0

Estimate 18: GAUSSIAN element: 
  Amplitude: 0.523377, 0
  Center:    645.266, 0
  Sigma:     3.01063, 0

Estimate 19: GAUSSIAN element: 
  Amplitude: 0.515985, 0
  Center:    446.61, 0
  Sigma:     1.18317, 0

---------------------------------------------------
Limited number of estimates: 
Found 4 estimates
Estimate 0: GAUSSIAN element: 
  Amplitude: 4.93017, 0
  Center:    307.195, 0
  Sigma:     3.05174, 0

Estimate 1: GAUSSIAN element: 
  Amplitude: 2.79525, 0
  Center:    511.819, 0
  Sigma:     3.29148, 0

Estimate 2: GAUSSIAN element: 
  Amplitude: 0.906691, 0
  Center:    766.653, 0
  Sigma:     2.31423, 0

Estimate 3: GAUSSIAN element: 
  Amplitude: 0.90563, 0
  Center:    501.372, 0
  Sigma:     3.60214, 0

---------------------------------------------------
