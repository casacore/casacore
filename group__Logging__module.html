<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>casacore: Logging_module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">casacore
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Logging_module<div class="ingroups"><a class="el" href="group__casa.html">casa package (libcasa_casa)</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Send, record, and filter informational messages.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__Logging__module__internal__classes"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Logging__module__internal__classes.html">Logging_module_internal_classes</a></td></tr>
<tr class="memdesc:group__Logging__module__internal__classes"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal Logging_module classes and functions. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LogFilter.html">casacore::LogFilter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filter LogMessages on message priority.  <a href="classcasacore_1_1LogFilter.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LogIO.html">casacore::LogIO</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">ostream-like interface to creating log messages.  <a href="classcasacore_1_1LogIO.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcasacore_1_1LogIO__global__functions__command.html">casacore::LogIO_global_functions_command</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions to send commands to a <a class="el" href="classcasacore_1_1LogIO.html" title="ostream-like interface to creating log messages. ">LogIO</a> object.  <a href="structcasacore_1_1LogIO__global__functions__command.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcasacore_1_1LogIO__global__functions__output.html">casacore::LogIO_global_functions_output</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions to accumulate text in the output message.  <a href="structcasacore_1_1LogIO__global__functions__output.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LogMessage.html">casacore::LogMessage</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Informational log messages with with time, priority, and origin.  <a href="classcasacore_1_1LogMessage.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcasacore_1_1LogMessage__global__functions__LogMessage__ostream.html">casacore::LogMessage_global_functions_LogMessage_ostream</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a <a class="el" href="classcasacore_1_1LogMessage.html" title="Informational log messages with with time, priority, and origin. ">LogMessage</a> to an ostream.  <a href="structcasacore_1_1LogMessage__global__functions__LogMessage__ostream.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LogOrigin.html">casacore::LogOrigin</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classcasacore_1_1LogOrigin.html" title="LogOrigin: The source code location of the originator of a LogMessage. ">LogOrigin</a>: The source code location of the originator of a <a class="el" href="classcasacore_1_1LogMessage.html" title="Informational log messages with with time, priority, and origin. ">LogMessage</a>.  <a href="classcasacore_1_1LogOrigin.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcasacore_1_1LogOrigin__global__functions__LogOrigin__ostream.html">casacore::LogOrigin_global_functions_LogOrigin_ostream</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a <a class="el" href="classcasacore_1_1LogOrigin.html" title="LogOrigin: The source code location of the originator of a LogMessage. ">LogOrigin</a> to an ostream.  <a href="structcasacore_1_1LogOrigin__global__functions__LogOrigin__ostream.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcasacore_1_1LogOrigin__global__functions__SourceLocation.html">casacore::LogOrigin_global_functions_SourceLocation</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper struct to get the source line.  <a href="structcasacore_1_1LogOrigin__global__functions__SourceLocation.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LogSink.html">casacore::LogSink</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distribute LogMessages to their destination(s)  <a href="classcasacore_1_1LogSink.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1MemoryLogSink.html">casacore::MemoryLogSink</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save log messages in memory.  <a href="classcasacore_1_1MemoryLogSink.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Send, record, and filter informational messages. </p>
<p><a class="anchor" id="Logging_module_anchor"></a> </p>
<p>See <a href="#Logging_module_Class_List">below</a> for an overview of the classes in this module.</p>
<h3>Prerequisite</h3>
<ul>
<li>
General Casacore utility classes, such as <a class="el" href="classcasacore_1_1String.html" title="String: the storage and methods of handling collections of characters. ">String</a>. </li>
</ul>
<h3>Review Status</h3>
<dl>
<dt>Reviewed By:</dt>
<dd>wbrouw</dd>
<dt>Date Reviewed:</dt>
<dd>1996/08/21</dd>
<dt>Test programs:</dt>
<dd>tLogging</dd>
<dt>Demo programs:</dt>
<dd>dLogging</dd>
</dl>
<h3>Etymology</h3>
<p>Logging, as in "log book", or "processing log."</p>
<h3>Synopsis</h3>
<p>The classes in the logging module have two essential purposes: </p>
<ol>
<li>
To attach processing logs to datasets to retain a permanent history of informational messages that describe how the dataset arrived at its present state; and </li>
<li>
To inform the user about the progress and decisions made by various algorithms, such as those used in the Measures system. </li>
</ol>
<p>The two fundamental classes in the Logging module are the <a class="el" href="classcasacore_1_1LogMessage.html">LogMessage</a> and <a class="el" href="classcasacore_1_1LogSink.html">LogSink</a> classes. However, the class which is most of interest to application programmers is the <a class="el" href="classcasacore_1_1LogIO.html">LogIO</a> class since it forms the usual interface to logging.</p>
<p>A <code><a class="el" href="classcasacore_1_1LogMessage.html" title="Informational log messages with with time, priority, and origin. ">LogMessage</a></code> consists of an informational message tagged with the time, a priority (<code>DEBUGGING, NORMAL,</code>, <code>WARN</code>, or <code>SEVERE</code>) and the source code location of the origin of the message (for use in debugging primarily).</p>
<p>The <code><a class="el" href="classcasacore_1_1LogSink.html" title="Distribute LogMessages to their destination(s) ">LogSink</a></code> is used to send the <code><a class="el" href="classcasacore_1_1LogMessage.html" title="Informational log messages with with time, priority, and origin. ">LogMessage</a></code> to its destinations. Usually the message will be sent to both a global sink, intended for user information (e.g., a GUI window), and to a sink associated with the dataset(s) which are being modified. In practice, the application programmer does not need to worry about where the global messages go, that policy is implemented by the Tasking system. In practice, global messages will be sent to Glish, where they will appear in a GUI, unless Glish is not available, in which case SEVERE messsages (only) will be sent to stdout. However, the principle is that "ordinary" application programmers shouldn't worry about the details of the global sink - they should just use it.</p>
<p>A <a class="el" href="classcasacore_1_1LogFilter.html">LogFilter</a> can be used to filter messages (based on priority only at the moment) before they are sent to their appropriate sink(s).</p>
<p>The <a class="el" href="classcasacore_1_1LogIO.html">LogIO</a> class puts an ostream like interface on top of the loggins system. Basically, the application programmer just has to create messages using and <code>os &lt;&lt; items</code> type interface.</p>
<p>The first issue that the application programmer has to decide is whether to use logging at all, or if instead he should put his messages into a <a class="el" href="classcasacore_1_1String.html">String</a> or an <code>ostream</code>. It is never wrong to use log messages, however it is reasonable for low level classes to use <code><a class="el" href="classcasacore_1_1String.html" title="String: the storage and methods of handling collections of characters. ">String</a></code>s or <code>ostream</code>s, since the caller of that class will have the opportunity to put the text in a log message if he decides that's the most appropriate thing to do. Note that it is always wrong to write directly to <code>cout</code> or <code>cerr</code> (other then for debugging) - use an <code>ostream</code>, so the caller can replace it with, for example, an <code>ostringstream</code>.</p>
<p>Once you decide to use logging, the application programmer only has to decide at every location he wants to log: </p>
<ol>
<li>
What content do you want the message to have; and </li>
<li>
what priority does the message have (DEBUGGING, NORMAL, WARN, SEVERE). </li>
</ol>
<p>Schematically, application programmers would use the logging system as follows: </p>
<div class="fragment"><div class="line"><span class="preprocessor"> #include &lt;<a class="code" href="Logging_8h.html">casacore/casa/Logging.h</a>&gt;</span></div>
<div class="line">..\.</div>
<div class="line"> <span class="keywordtype">void</span> MyClass:myFunction(LogIO &amp;os)</div>
<div class="line"> {</div>
<div class="line"> os &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5a568630f32bcc1f21d00134c720db8661">LogIO::NORMAL</a> &lt;&lt; LogOrigin(<span class="stringliteral">&quot;MyClass&quot;</span>, <span class="stringliteral">&quot;myFunction()&quot;</span>, <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a>);   <span class="comment">// 1</span></div>
<div class="line">..\.</div>
<div class="line"> os &lt;&lt; <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a> &lt;&lt; <span class="stringliteral">&quot;An informative message&quot;</span>) &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5accb0248e58077c73d9a49effc2e6bff8">LogIO::POST</a>;              <span class="comment">// 2</span></div>
<div class="line"> <span class="keywordflow">if</span> (error()) {</div>
<div class="line"> os &lt;&lt; <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a> &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5a0478ddd27ae86cd5e87fa785f673ca3d">LogIO::SEVERE</a> &lt;&lt; <span class="stringliteral">&quot;Error!&quot;</span> &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5accb0248e58077c73d9a49effc2e6bff8">LogIO::POST</a>;          <span class="comment">// 3</span></div>
<div class="line"> sink.post(msg);</div>
<div class="line">..\.</div>
<div class="line"> }</div>
<div class="line"> }</div>
</div><!-- fragment --> <ol>
<li>
Set up the location where log messages come from. WHERE will expand into the file name and line number (useful for debugging). Set the priority to NORMAL (this is the default, but you don't know what the state of <code>os</code> is when it is passed in to this function). </li>
<li>
Set the message and the new line number (optional but encouraged) and post it. </li>
<li>
Change the priority to SEVERE and post an error message. </li>
</ol>
<p>When a dataset is created from several other datasets, their input "histories" should be merged if possible. This can be done if the local log sink is in fact a <a class="el" href="classcasacore_1_1Table.html" title="Main interface class to a read/write table. ">Table</a>. The way you do this is by interrogating the local sink to find out if it is in fact a <a class="el" href="classcasacore_1_1TableLogSink.html" title="Save log messages in a Casacore Table. ">TableLogSink</a>. If it is, you can use a concatenate method of <a class="el" href="classcasacore_1_1TableLogSink.html" title="Save log messages in a Casacore Table. ">TableLogSink</a>. Schematically this would be implemented as follows in some DataSet class that has a logSink method that returns a <a class="el" href="classcasacore_1_1LogIO.html" title="ostream-like interface to creating log messages. ">LogIO</a> reference: </p>
<div class="fragment"><div class="line"> <span class="keywordtype">void</span> merge(DataSet &amp;out, <span class="keyword">const</span> DataSet &amp;in1, <span class="keyword">const</span> DataSet &amp;in2) {</div>
<div class="line">... <a class="code" href="namespacecasacore.html#a15f0038653cf981c26965a85e2985480">copy</a> the data from in1 and in2 to out</div>
<div class="line"> <span class="keywordflow">if</span> (out.logSink().localSink().isTableLogSink()) { <span class="comment">// can write to out</span></div>
<div class="line"> <span class="keywordflow">if</span> (in1.logSink().localSink().isTableLogSink()) {</div>
<div class="line"> out.logSink().localSink().castToTableLogSink().concatenate(</div>
<div class="line"> in1.logSink().localSink().castToTableLogSink());</div>
<div class="line"> }</div>
<div class="line"> <span class="keywordflow">if</span> (... the same <span class="keywordflow">for</span> in2...)</div>
<div class="line"> }</div>
</div><!-- fragment --><p> Of course, DataSet might provide some convenience function for merging histories. However the point is that given a sink, you can safely determing whether or not it is in fact a <a class="el" href="classcasacore_1_1TableLogSink.html" title="Save log messages in a Casacore Table. ">TableLogSink</a>, and if it is you can call its concatenate function, which takes another <a class="el" href="classcasacore_1_1TableLogSink.html" title="Save log messages in a Casacore Table. ">TableLogSink</a>.</p>
<h3>Example</h3>
<p><a class="anchor" id="Logging_example1"></a> The following example code is checked into the system as <code>dLogging.cc</code>. It is found in the Logging test directory.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>DataClass</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">DataClass(<span class="keyword">const</span> IPosition &amp;<a class="code" href="namespacecasacore.html#a6c80d55c1617e8540e006c12e3dc990c">shape</a>, <span class="keyword">const</span> LogSink &amp;sink);  <span class="comment">// 1</span></div>
<div class="line"><span class="keywordtype">void</span> set(<a class="code" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> toWhat);                                    <span class="comment">// 2</span></div>
<div class="line">LogIO   &amp;sink() return os_p;}                            <span class="comment">// 3</span></div>
<div class="line">Array&lt;<a class="code" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a>&gt; &amp;data() {<span class="keywordflow">return</span> data_p;}                      <span class="comment">// 4</span></div>
<div class="line"><span class="keyword">const</span> Array&lt;Int&gt; &amp;data()<span class="keyword"> const </span>{<span class="keywordflow">return</span> data_p;}          <span class="comment">// 5</span></div>
<div class="line"><span class="keyword">private</span>:                                                   <span class="comment">// 6</span></div>
<div class="line">Vector&lt;Int&gt; data_p;                                      <span class="comment">// 7</span></div>
<div class="line">LogSink log_sink_p;                                      <span class="comment">// 8</span></div>
<div class="line">LogIO os_p;                                              <span class="comment">// 9</span></div>
<div class="line">};</div>
</div><!-- fragment --><p>This toy class is meant to represent one which is to have "attached" logging information. Generally, these classes would be fairly high level astronomical classes, e.g. <code>Image</code>, not <code><a class="el" href="classcasacore_1_1Array.html" title="A templated N-D Array class with zero origin. Array&lt;T, Alloc&gt; is a templated, N-dimensional, Array class. The origin is zero, but by default indices are zero-based. This Array class is the base class for the Vector, Matrix, and Cube subclasses. ">Array</a></code>. Note that only operations which change the data should be logged in the internal log. Operations which only read the data should be logged either globally, or in the class that is taking the results and modifying its own data.</p>
<dl>
<dt>1. </dt>
<dd>Depending on the application, the <a class="el" href="classcasacore_1_1LogSink.html" title="Distribute LogMessages to their destination(s) ">LogSink</a> to be used might either be handed in to the class, as is the case here, or it might be created by the class. For example, a <code><a class="el" href="classcasacore_1_1MeasurementSet.html" title="A Table intended to hold astronomical data (a set of Measurements). ">MeasurementSet</a></code> will have a processing log table with a known name. </dd>
<dt>2. </dt>
<dd>A sample function that changes the state of the class. Here, it just sets all the elements of the internal array to <code>toWhat</code>. </dd>
<dt>3. </dt>
<dd>Return the <a class="el" href="classcasacore_1_1LogIO.html" title="ostream-like interface to creating log messages. ">LogIO</a> that is used by this object. A member function like this should be provided for use by global functions which manipulate the object. Note that it is non-const &mdash; the internal sink should be modified only by functions which CHANGE the object, otherwise the global sink should be used. </dd>
<dt>4. </dt>
<dd>Return the internal data. Arguably this should be logged at at least DEBUGGING level. </dd>
<dt>5. </dt>
<dd>Non-const version of the above. Note that it should not be logged since the state cannot be changed with this function. </dd>
<dt>7. </dt>
<dd>The internal data member. </dd>
<dt>8. </dt>
<dd>The location to which log mesages are sent. </dd>
<dt>9. </dt>
<dd>The <a class="el" href="classcasacore_1_1LogIO.html" title="ostream-like interface to creating log messages. ">LogIO</a> object that will be the actual interface to the logging system. </dd>
</dl>
<div class="fragment"><div class="line">DataClass::DataClass(<span class="keyword">const</span> IPosition &amp;<a class="code" href="namespacecasacore.html#a6c80d55c1617e8540e006c12e3dc990c">shape</a>, <span class="keyword">const</span> LogSink &amp;sink)</div>
<div class="line">: log_sink_p(sink), os_p(log_sink_p)                                     <span class="comment">// 1</span></div>
<div class="line">{                                                                          <span class="comment">// 2</span></div>
<div class="line">os_p &lt;&lt; LogOrigin(<span class="stringliteral">&quot;DataClass&quot;</span>,                                           <span class="comment">// 3</span></div>
<div class="line"><span class="stringliteral">&quot;DataClass(const IPosition &amp;shape, const LogSink &amp;sink)&quot;</span>);  <span class="comment">// 4</span></div>
<div class="line"><span class="comment">// 5</span></div>
<div class="line"><span class="keywordflow">if</span> (shape.nelements() != 1) {                                            <span class="comment">// 6</span></div>
<div class="line">os_p &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5a0478ddd27ae86cd5e87fa785f673ca3d">LogIO::SEVERE</a> &lt;&lt; <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a> &lt;&lt;                                      <span class="comment">// 7</span></div>
<div class="line"><span class="stringliteral">&quot;Illegal Shape! Must be one dimensional.&quot;</span> &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5a3b641b46ef5c65c0b176e6192ef3effa">LogIO::EXCEPTION</a>;       <span class="comment">// 8</span></div>
<div class="line">}                                                                        <span class="comment">// 9</span></div>
<div class="line"><span class="comment">// 10</span></div>
<div class="line">data_p.resize(<a class="code" href="classcasacore_1_1UDFBase.html#a539424e1a932744a32a5411ec543ece1">shape</a>(0));                                                 <span class="comment">// 11</span></div>
<div class="line">os_p &lt;&lt; <span class="stringliteral">&quot;Inital shape &quot;</span> &lt;&lt; shape &lt;&lt; <span class="stringliteral">&quot;and value 2&quot;</span> &lt;&lt;                     <span class="comment">// 12</span></div>
<div class="line"><a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5a568630f32bcc1f21d00134c720db8661">LogIO::NORMAL</a> &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5accb0248e58077c73d9a49effc2e6bff8">LogIO::POST</a>;                                        <span class="comment">// 13</span></div>
<div class="line"><span class="comment">// 14</span></div>
<div class="line">set(2);                                                                  <span class="comment">// 15</span></div>
<div class="line">}</div>
</div><!-- fragment --> <dl>
<dt>1. </dt>
<dd><p class="startdd">The private <code><a class="el" href="classcasacore_1_1LogSink.html" title="Distribute LogMessages to their destination(s) ">LogSink</a></code> data member is initialized with one that the caller provides. Note that <a class="el" href="classcasacore_1_1LogSink.html" title="Distribute LogMessages to their destination(s) ">LogSink</a> uses reference semantics, so that if another "copy" of the sink is made then all the log messages will go to the same place. For example: </p>
<div class="fragment"><div class="line"> LogSink a(<span class="stringliteral">&quot;mylogtable&quot;</span>);</div>
<div class="line"> LogSink b(a);</div>
<div class="line"> LogSink <a class="code" href="namespacecasacore_1_1C.html#a2aff9552bacab8d7213d5c70f7f23dc9">c</a>;</div>
<div class="line"> c = a;</div>
<div class="line">..\.</div>
<div class="line"> c.post(...);  <span class="comment">// ends up in mylogtable</span></div>
<div class="line">..\.</div>
<div class="line"> b.post(...);  <span class="comment">// as does this</span></div>
</div><!-- fragment --><p> This can be useful if several classes might be modifying the same data, or if a data is spread over several objects.</p>
<p class="enddd">Also, os_p is intialized from the sink. </p>
</dd>
<dt>3. </dt>
<dd>For a member function, the first argument to <a class="el" href="classcasacore_1_1LogOrigin.html" title="LogOrigin: The source code location of the originator of a LogMessage. ">LogOrigin</a> is the class name. </dd>
<dt>4. </dt>
<dd>The next argument is the function name. You should use the full name with arguments so that you can use the argument name in your messages. Leave off the return type. Cutting and pasting is easier than typing! </dd>
<dt>7. </dt>
<dd>WHERE is a predefined macro that gives the file name and line number. </dd>
<dt>8. </dt>
<dd>Create a SEVERE level error message, post it and throw an exception. </dd>
<dt>11. </dt>
<dd>This will post the message locally and globally, and then throw an exception. Another possibility would be to call <code>postGloballyThenThrow()</code> if you only wanted to send the message to the global sink (for example, if the object is hopelessly corrupted, or if the problem occurs in a read-only operation). The thrown exception is an <code><a class="el" href="classcasacore_1_1AipsError.html" title="Base class for all Casacore library errors. ">AipsError</a></code>. The <code>post*Throw()</code> functions will always set the priority to <code>SEVERE</code>, however it doesn't hurt to show your intentions </dd>
<dt>12. </dt>
<dd>Create and send a NORMAL priority message. </dd>
<dt>15. </dt>
<dd>Call <code>set()</code> from the constructor to give the data values an initial value. </dd>
</dl>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> DataClass::set(<a class="code" href="namespacecasacore.html#abb6e2c1bac472ca1ebadadf96cc8426f">Int</a> toWhat)</div>
<div class="line">{</div>
<div class="line">os_p &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5a568630f32bcc1f21d00134c720db8661">LogIO::NORMAL</a> &lt;&lt; LogOrigin(<span class="stringliteral">&quot;DataClass&quot;</span>, <span class="stringliteral">&quot;set(Int toWhat)&quot;</span>);      <span class="comment">// 1</span></div>
<div class="line">os_p &lt;&lt; <span class="stringliteral">&quot;Setting data values to &quot;</span> &lt;&lt; toWhat &lt;&lt; <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a> &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5accb0248e58077c73d9a49effc2e6bff8">LogIO::POST</a>;     <span class="comment">// 2</span></div>
<div class="line"><a class="code" href="namespacecasacore.html#a5c559d8d8bf2ae7f67b439955d6be88a">uInt</a> n = data_p.nelements();                                             <span class="comment">// 3</span></div>
<div class="line"><span class="keywordflow">for</span> (<a class="code" href="namespacecasacore.html#a5c559d8d8bf2ae7f67b439955d6be88a">uInt</a> i=0; i &lt; n; i++) {                                             <span class="comment">// 4</span></div>
<div class="line"><span class="preprocessor">#ifdef AIPS_DEBUG                                                          // 5</span></div>
<div class="line"><span class="preprocessor"></span>os_p &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5ab3db7406db1cc213ba761c4c1b7284e7">LogIO::DEBUGGING</a> &lt;&lt; <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a> &lt;&lt;                                   <span class="comment">// 6</span></div>
<div class="line"><span class="stringliteral">&quot;Setting element  &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; toWhat &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5accb0248e58077c73d9a49effc2e6bff8">LogIO::POST</a>;         <span class="comment">// 7</span></div>
<div class="line"><span class="preprocessor">#endif                                                                     // 8</span></div>
<div class="line"><span class="preprocessor"></span>data_p(i) = toWhat;                                                    <span class="comment">// 9</span></div>
<div class="line">}</div>
<div class="line">}</div>
</div><!-- fragment --><dl>
<dt>2. </dt>
<dd>This and the previous line set up and send a normal priority log message much as we did previously. </dd>
<dt>7. </dt>
<dd><p class="startdd">LogMessages are relatively expensive to produces and consume. Use of them in a very tight loop should either be <code>ifdef</code>'d out as in this example, or like: </p>
<div class="fragment"><div class="line"> <span class="keywordflow">if</span> (<a class="code" href="namespacecasacore.html#abedba2c06fdc94b8e34fdc3831f6216c">aips_debug_on</a>) {</div>
<div class="line">... set up and send <a class="code" href="namespacecasacore.html#ab27ed895e7dca6906870eaaa8b6d450c">log</a> message..\.</div>
<div class="line"> }</div>
</div><!-- fragment --><p> The advantage of this code is that it's always available - so, for example, you can turn it on and off by manipulating the global variable <code>aips_debug_on</code>. However very tight loops cannot even afford this extra <code>if</code>, and should prefer the <code>ifdef</code>.</p>
<p class="enddd">Normally the <code>DEBUGGING</code> messages are "boring but low-volume", and you should just send them normally. </p>
</dd>
</dl>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="namespacecasacore.html#a81061defb229f93e7422132122ea28c7">square</a>(DataClass &amp;<span class="keywordtype">object</span>)</div>
<div class="line">{</div>
<div class="line"><span class="keywordtype">object</span>.sink() &lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5a568630f32bcc1f21d00134c720db8661">LogIO::NORMAL</a> &lt;&lt; <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a> &lt;&lt;                              <span class="comment">// 1</span></div>
<div class="line">LogOrigin(<span class="stringliteral">&quot;square(DataClass &amp;object)&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;Squaring data elements&quot;</span>    <span class="comment">// 2</span></div>
<div class="line">&lt;&lt; <a class="code" href="classcasacore_1_1LogIO.html#a3f637084f2b7120bb3822cf345e19dd5accb0248e58077c73d9a49effc2e6bff8">LogIO::POST</a>;                                                    <span class="comment">// 3</span></div>
<div class="line"><span class="keywordtype">object</span>.data() *= <span class="keywordtype">object</span>.data();                                         <span class="comment">// 4</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>This function shows how a global function that modifies an object can send log messages to that objects <code><a class="el" href="classcasacore_1_1LogSink.html" title="Distribute LogMessages to their destination(s) ">LogSink</a></code> using a function of that object to get access to its sink.</p>
<div class="fragment"><div class="line"><span class="keywordtype">float</span> <a class="code" href="namespacecasacore.html#a52e94a0f970eb5350dc39688ffd25a5f">sum</a>(<span class="keyword">const</span> DataClass &amp;<span class="keywordtype">object</span>)</div>
<div class="line">{</div>
<div class="line">LogIO global(LogOrigin(<span class="stringliteral">&quot;sum(const DataClass &amp;object)&quot;</span>));        <span class="comment">// 1</span></div>
<div class="line"><span class="keywordtype">float</span> theSum = <a class="code" href="namespacecasacore.html#a52e94a0f970eb5350dc39688ffd25a5f">sum</a>(<span class="keywordtype">object</span>.data());                              <span class="comment">// 2</span></div>
<div class="line">global &lt;&lt; <a class="code" href="LogOrigin_8h.html#acd4a2dee55f5359c0389baab37c2f468">WHERE</a> &lt;&lt; <span class="stringliteral">&quot;Sum of object is: &quot;</span> &lt;&lt; theSum;              <span class="comment">// 3 </span></div>
<div class="line"><span class="keywordflow">return</span> theSum;                                                  <span class="comment">// 4</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> This is an example of a global function that only reads &ndash; does not change &ndash; an object. </p>
<dl>
<dt>3. </dt>
<dd>Since we are not changing the data object, we only post the message globally, we don't write it to the data object's log sink. The caller of <code><a class="el" href="namespacecasacore.html#a52e94a0f970eb5350dc39688ffd25a5f">sum()</a></code> might log the message somewhere else if the return value is used to modify data in some other object. Instead we send it to the global sink. Here we don't POST the message ourselves, we rely on the <a class="el" href="classcasacore_1_1LogIO.html" title="ostream-like interface to creating log messages. ">LogIO</a> destructor to do it for us. </dd>
</dl>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line"><a class="code" href="classcasacore_1_1LogSink.html#aab821878d668f710b53365175f1cc8d9">LogSink::globalSink</a>().<a class="code" href="classcasacore_1_1LogSinkInterface.html#a44653d1ebb204f2afaddae69cb4ed2a3">filter</a>(<a class="code" href="classcasacore_1_1LogMessage.html#a9390a9080539b47c70f284640dd401f4a5d39b0654346fd3ecb4e75541f72d6a3">LogMessage::DEBUGGING</a>);           <span class="comment">// 1</span></div>
<div class="line">LogSink logger(<a class="code" href="classcasacore_1_1LogMessage.html#a9390a9080539b47c70f284640dd401f4af75d8b953bfc0ee6a71100cd656816b4">LogMessage::NORMAL</a>, <span class="stringliteral">&quot;dLogging_messages_tmp&quot;</span>);   <span class="comment">// 2</span></div>
<div class="line"><span class="comment">// 3</span></div>
<div class="line">IPosition legalShape(1, 10);                                   <span class="comment">// 4</span></div>
<div class="line">DataClass dc(legalShape, logger);                              <span class="comment">// 5</span></div>
<div class="line"><span class="comment">// 6</span></div>
<div class="line"><a class="code" href="namespacecasacore.html#a81061defb229f93e7422132122ea28c7">square</a>(dc);                                                    <span class="comment">// 7</span></div>
<div class="line"><span class="comment">// 8</span></div>
<div class="line"><a class="code" href="namespacecasacore.html#a8e2f856944a61553ab74cd041314f696">Float</a> total = <a class="code" href="namespacecasacore.html#a52e94a0f970eb5350dc39688ffd25a5f">sum</a>(dc);                                         <span class="comment">// 9</span></div>
<div class="line"><span class="comment">// 10</span></div>
<div class="line"><span class="keywordflow">return</span> 0;                                                      <span class="comment">// 11</span></div>
<div class="line">}</div>
</div><!-- fragment --> <dl>
<dt>1. </dt>
<dd>Change the priority of messages to display on the global sink's filter to <code>DEBUGGING</code> from the default <code>NORMAL</code>. The default global sink logs to cerr. The global sink can be replaced with <code><a class="el" href="classcasacore_1_1LogSink.html#aab821878d668f710b53365175f1cc8d9" title="Get/set the global sink or check if the global sink is null. ">LogSink::globalSink()</a></code>. </dd>
<dt>2. </dt>
<dd>Create the sink that we are going to use. This constructor will use a <a class="el" href="classcasacore_1_1Table.html">Table</a>. If the table doesn't exist it will be created. If it does exist, new log messages will be appended to the end. </dd>
<dt>5. </dt>
<dd>Create an object with the provided sink. The alternative strategy, which will be used with classes like <a class="el" href="classcasacore_1_1MeasurementSet.html">MeasurementSet</a> is for the object to make it's own <code><a class="el" href="classcasacore_1_1LogSink.html" title="Distribute LogMessages to their destination(s) ">LogSink</a></code> if it knows where it wants its messages to go. </dd>
<dt>7. </dt>
<dd>Changes the data - log messages go to its local sink. </dd>
<dt>9. </dt>
<dd>Reads the data - log messages go only to the global sink. </dd>
</dl>
<h3>Motivation</h3>
<ol>
<li>
Attaching informational messages to datasets to describe their processing history. </li>
<li>
Informational messages to inform the user about the progress and parameters of algorithms - for example those used for reference frame conversions in the Measures module. </li>
</ol>
<h3>To Do</h3>
<ul>
<li>
More filtering options? </li>
</ul>
<p><a class="anchor" id="Logging_module_Class_List"></a> </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
