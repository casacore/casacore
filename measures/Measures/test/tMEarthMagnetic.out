Test Earth Magnetic field
--------------------------------------

MEarthMagnetic state transition matrix:

   |  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
-------------------------------------------------------------------
  0| --  6  6 14  4  4  4  2 14 14 14 14 14 14 30  6  6  2 14 14 43
   |     1  1 13  4  4  4  7 13 13 13 13 13 13 14  1  1  7 13 13 20
  1|  8 --  9  8  8  8  8  8  8  8  8  8  8  8  8 32  9  8  8  8  8
   |  0     2  0  0  0  0  0  0  0  0  0  0  0  0 15  2  0  0  0  0
  2| 12 12 -- 12 12 12 12 12 12 12 12 12 12 12 12 12 34 12 12 12 12
   |  1  1     1  1  1  1  1  1  1  1  1  1  1  1  1 16  1  1  1  1
  3| 28 28 28 -- 17 17 17 28 18 18 18 18 18 28 28 28 28 28 18 18 28
   | 13 13 13     4  4  4 13 19 19 19 19 19 13 13 13 13 13 19 19 13
  4|  5  5  5 16 --  7  7  3 16 16 16 16 16  5  5  5  5  3 16 16  5
   |  0  0  0  3     5  5  7  3  3  3  3  3  0  0  0  0  7  3  3  0
  5| 10 10 10 10 10 -- 11 10 10 10 10 10 10 10 10 10 10 10 10 10 10
   |  4  4  4  4  4     6  4  4  4  4  4  4  4  4  4  4  4  4  4  4
  6| 13 13 13 13 13 13 -- 13 13 13 13 13 13 13 13 13 13 13 13 13 13
   |  5  5  5  5  5  5     5  5  5  5  5  5  5  5  5  5  5  5  5  5
  7|  0  0  0  0  1  1  1 --  0  0  0  0  0  0  0  0  0 36  0  0  0
   |  0  0  0  0  4  4  4     0  0  0  0  0  0  0  0  0 17  0  0  0
  8| 23 23 23 23 23 23 23 23 -- 19 19 20 20 23 23 23 23 23 39 23 23
   | 19 19 19 19 19 19 19 19     9  9 11 11 19 19 19 19 19 18 19 19
  9| 21 21 21 21 21 21 21 21 21 -- 24 21 21 21 21 21 21 21 21 21 21
   |  8  8  8  8  8  8  8  8  8    10  8  8  8  8  8  8  8  8  8  8
 10| 26 26 26 26 26 26 26 26 26 26 -- 26 26 26 26 26 26 26 26 26 26
   |  9  9  9  9  9  9  9  9  9  9     9  9  9  9  9  9  9  9  9  9
 11| 22 22 22 22 22 22 22 22 22 22 22 -- 25 22 22 22 22 22 22 22 22
   |  8  8  8  8  8  8  8  8  8  8  8    12  8  8  8  8  8  8  8  8
 12| 27 27 27 27 27 27 27 27 27 27 27 27 -- 27 27 27 27 27 27 27 27
   | 11 11 11 11 11 11 11 11 11 11 11 11    11 11 11 11 11 11 11 11
 13| 15 15 15 29 15 15 15 15 29 29 29 29 29 -- 15 15 15 15 29 29 15
   |  0  0  0  3  0  0  0  0  3  3  3  3  3     0  0  0  0  3  3  0
 14| 31 31 31 31 31 31 31 31 31 31 31 31 31 31 -- 31 31 31 31 31 31
   |  0  0  0  0  0  0  0  0  0  0  0  0  0  0     0  0  0  0  0  0
 15| 33 33 33 33 33 33 33 33 33 33 33 33 33 33 33 -- 33 33 33 33 33
   |  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1     1  1  1  1  1
 16| 35 35 35 35 35 35 35 35 35 35 35 35 35 35 35 35 -- 35 35 35 35
   |  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2     2  2  2  2
 17| 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 37 -- 37 37 37
   |  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7  7     7  7  7
 18| 38 38 38 38 38 38 38 38 38 38 38 38 38 38 38 38 38 38 -- 38 38
   |  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8     8  8
 19| 41 41 41 41 41 41 41 41 40 40 40 40 40 41 41 41 41 41 40 -- 41
   |  3  3  3  3  3  3  3  3  8  8  8  8  8  3  3  3  3  3  8     3
 20| 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 --
   |  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   

Date:      1998/05/18
Position:  [6.36457e+06, 0.115264, 0.92034]
           [6.60417, 52.7316] deg
Result:    [41647.4, 1813.7, 24906]
------------------------------------------
In ITRF:   EarthMagnetic: [41647.4, 1813.7, 24906]
           [2.49359, 30.8564] deg
In AZEL:   EarthMagnetic: [-18007.6, -2988.18, 44998.9]
           [-170.578, 67.9201] deg
In HADEC:  EarthMagnetic: [41579.6, 2988.18, 24906]
           [4.11057, 30.8564] deg
------------------------------------------
In AZEL:   EarthMagnetic: [18312.1, -382.004, 45184.5]
           [-1.19506, 67.9342] deg
In HADEC:  EarthMagnetic: [12788.5, 382.004, 47047.1]
           [1.71096, 74.7866] deg
In ITRF:   EarthMagnetic: [12747.6, 1091.33, 47047.1]
           [4.8932, 74.7866] deg
------------------------------------------
Model ITRF:   EarthMagnetic: [41647.4, 1813.7, 24906]
              [2.49359, 30.8564] deg, 0.485603 G
Model AZEL:   EarthMagnetic: [-18007.6, -2988.18, 44998.9]
              [-170.578, 67.9201] deg, 0.485603 G
Model HADEC:  EarthMagnetic: [41579.6, 2988.18, 24906]
              [4.11057, 30.8564] deg, 0.485603 G
--------------------------------------
Testing all conversions forward/backward
All forward/backward Magnetic conversions: ok
--------------------------------------
Exercise all MVEarthMagnetic function
putValue:       [23 G, 23 G, 23 G], [0.0023, 0.0023, 0.0023]
earthMagneticAngle:  -1.479
earthMagneticAngle:  -84.7407 deg
get:            [0.00398372, 0.785398, 0.61548]
getRecordValue: [0.0023 nT, 0.0023 nT, 0.0023 nT]
separation:     3.14159
separation:     180 deg
crossProduct:   [53.1124, 38.5051, -91.6175]
getAngle:       [0.785398, 0.61548] rad
getAngle:       [45, 35.2644] deg
getlength:      3.98372e-08 G
radius:         0.00398372
putVector:      [30, 40, 0], [30, 40, 0]
VQ constructor: [0.0023, 0.0023, 0.0023]
Q constructor:  [0, 0, 0.005]
QV constructor: [0.57735, 0.57735, 0.57735]
QV constructor: [0.00196299, 0.00196299, 0.00196299]
V constructor:  [30, 40, 0]
D constructor:  [0, 0, 78]
operator+:      [30.0023, 40.0023, 0.0023]
operator-:      [29.9977, 39.9977, -0.0023]
operator-pre-:  [-0.0023, -0.0023, -0.0023]
operator*:      [0.0023, 0.00197536, 0.00258418]
operator*:      [0.0046, 0.0046, 0.0046]
assure:         ok
getLength:      50 nT
operator*:      2500
operator*       0.161
operator*:      2500
clone:          [30, 40, 0]
getVector:      [30, 40, 0]
near:           0
near:           0
nearAbs:        0
!=:             1
==:             0
type:           3
All MVEarthMagnetic functions: ok
----------------------------
Exercise all MEarthMagnetic function
getType:        1, 9
giveMe:         1, Reference for an EarthMagnetic with Type: AZEL
setRefString:   1, EarthMagnetic: [41647.4, 1813.7, 24906]
assure:         ok
clone:          EarthMagnetic: [41647.4, 1813.7, 24906]
get:            [4.16474e+06, 181370, 2.4906e+06] cm.m-1.kg.s-2.A-1
getAngle:       [2.49359, 30.8564] deg
getDefaultType: IGRF
getRefString:   HADEC
myType:         4
type:           4
All MEarthMagnetic functions: ok
---------------------------
------------------------------------------
